<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Fireworks Test</title>
<style>
html,body{
  margin:0;
  width:100%;
  height:100%;
  background:#000;
  overflow:hidden;
}
#fw{
  position:fixed;
  inset:0;
}
</style>
</head>
<body>

<canvas id="fw"></canvas>

<script>
const canvas = document.getElementById('fw');
const ctx = canvas.getContext('2d');
let W,H,dpr=Math.min(2,window.devicePixelRatio||1);

function resize(){
  W=window.innerWidth;
  H=window.innerHeight;
  canvas.width=W*dpr;
  canvas.height=H*dpr;
  ctx.setTransform(dpr,0,0,dpr,0,0);
}
resize();
window.addEventListener('resize',resize);

const rockets=[], sparks=[];
const colors=['#ff4d4d','#ffd166','#06c755','#4dd0ff','#b388ff','#ff7aff'];
const rand=(a,b)=>a+Math.random()*(b-a);

function launch(){
  rockets.push({
    x: rand(0,W),
    y: H+20,
    vy: rand(-10,-7),
    vx: rand(-0.6,0.6),
    explodeY: rand(H*0.1, H*0.3),
    color: colors[(Math.random()*colors.length)|0]
  });
}

function explode(r){
  for(let i=0;i<60;i++){
    const a=Math.random()*Math.PI*2;
    const s=Math.random()*4+2;
    sparks.push({
      x:r.x,y:r.y,
      vx:Math.cos(a)*s,
      vy:Math.sin(a)*s,
      life:60,
      age:0,
      color:r.color
    });
  }
}

function tick(){
  ctx.fillStyle='rgba(0,0,0,0.25)';
  ctx.fillRect(0,0,W,H);

  if(Math.random()<0.12) launch();

  for(let i=rockets.length-1;i>=0;i--){
    const r=rockets[i];
    r.x+=r.vx;
    r.y+=r.vy;
    r.vy+=0.12;
    ctx.fillStyle=r.color;
    ctx.beginPath();
    ctx.arc(r.x,r.y,2.5,0,Math.PI*2);
    ctx.fill();
    if(r.y<r.explodeY){
      explode(r);
      rockets.splice(i,1);
    }
  }

  for(let i=sparks.length-1;i>=0;i--){
    const s=sparks[i];
    s.x+=s.vx;
    s.y+=s.vy;
    s.vy+=0.05;
    s.age++;
    ctx.globalAlpha=1-s.age/s.life;
    ctx.fillStyle=s.color;
    ctx.beginPath();
    ctx.arc(s.x,s.y,2,0,Math.PI*2);
    ctx.fill();
    ctx.globalAlpha=1;
    if(s.age>s.life) sparks.splice(i,1);
  }
  requestAnimationFrame(tick);
}
tick();
</script>
</body>
</html>
