<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>爆分攻略落地頁</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      background:#000;
      color:#fff;
      min-height:100vh;
      padding-bottom:120px; /* 預留底部按鈕空間 */
      font-family:-apple-system, BlinkMacSystemFont,"SF Pro Text","Segoe UI",system-ui,sans-serif;
      display:flex;
      justify-content:center;
    }

    /* 手機版滿版寬度，桌機也用同樣窄版寬度 */
    .page {
      width:100%;
      max-width:430px;    /* 模擬手機寬度，桌機也是用這個寬度 */
      margin:0 auto;
    }

    /* 輪播：寬度跟 page 一樣，圖片完整顯示 */
    .carousel-wrapper {
      width:100%;
      margin:0 auto 10px auto;
      position:relative;
      overflow:hidden;
      border-radius:12px;
      background:#000;
    }
    .carousel-inner {
      display:flex;
      width:100%;
      transition:transform 0.4s ease;
    }
    .carousel-slide {
      min-width:100%;
      flex-shrink:0;
    }
    .carousel-slide img {
      width:100%;
      height:auto;       /* 保持比例，完整顯示圖片 */
      display:block;
    }

    .carousel-dots {
      position:absolute;
      left:50%;
      bottom:8px;
      transform:translateX(-50%);
      display:flex;
      gap:6px;
      z-index:10;
    }
    .carousel-dot {
      width:8px;
      height:8px;
      border-radius:50%;
      background:rgba(255,255,255,0.4);
    }
    .carousel-dot.active {
      background:#fff;
    }

    /* 背景圖：跟 page 同寬，完整顯示 */
    .main-bg {
      width:100%;
      height:auto;
      display:block;
    }

    /* 底部固定按鈕 */
    .fixed-btn {
      position:fixed;
      left:50%;
      bottom:16px;
      transform:translateX(-50%);
      z-index:9999;
      text-decoration:none;
      animation:breathing 2.5s ease-in-out infinite;
      transition:transform 0.15s ease, filter 0.15s ease;
    }
    .fixed-btn img {
      width:90vw;
      max-width:360px;
      display:block;
    }
    @keyframes breathing {
      0%{transform:translateX(-50%) scale(1);}
      50%{transform:translateX(-50%) scale(1.08);}
      100%{transform:translateX(-50%) scale(1);}
    }
    .fixed-btn:active {
      transform:translateX(-50%) scale(0.92);
      filter:brightness(1.2);
      animation:none;
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- 輪播區 -->
    <div id="banner-carousel" class="carousel-wrapper">
      <div id="carousel-inner" class="carousel-inner"></div>
      <div id="carousel-dots" class="carousel-dots"></div>
    </div>

    <!-- 背景長圖 -->
    <img src="img/bg.png" alt="爆分攻略落地頁" class="main-bg">
  </div>

  <!-- 底部固定呼吸按鈕 -->
  <a href="https://fbads88.gm89.net/login?id=register" class="fixed-btn">
    <img src="img/button.png" alt="領取爆分攻略">
  </a>

  <script>
    (function(){
      const REGISTER_URL = "https://fbads88.gm89.net/login?id=register";
      const MAX_BANNERS = 20;
      const PREFIX = "bn/";

      const carouselWrapper = document.getElementById("banner-carousel");
      const inner = document.getElementById("carousel-inner");
      const dotsWrap = document.getElementById("carousel-dots");

      let banners = [];
      let pending = 0;
      let currentIndex = 0;
      let autoTimer = null;
      let touchStartX = null;
      let isSwiping = false;

      function loadBanners() {
        for (let i = 1; i <= MAX_BANNERS; i++) {
          const num = String(i).padStart(3, "0");
          const src = PREFIX + num + ".png";
          pending++;
          const img = new Image();
          img.onload = function(){ banners.push(src); checkDone(); };
          img.onerror = function(){ checkDone(); };
          img.src = src;
        }
      }

      function checkDone() {
        pending--;
        if (pending === 0) {
          if (banners.length === 0) {
            carouselWrapper.style.display = "none";
          } else {
            initCarousel();
          }
        }
      }

      function initCarousel() {
        banners.forEach(function(src, idx) {
          const slide = document.createElement("div");
          slide.className = "carousel-slide";
          const img = document.createElement("img");
          img.src = src;
          img.alt = "banner " + (idx + 1);
          slide.appendChild(img);
          inner.appendChild(slide);

          const dot = document.createElement("div");
          dot.className = "carousel-dot" + (idx === 0 ? " active" : "");
          dotsWrap.appendChild(dot);
        });

        // 點擊輪播 → 跳轉
        carouselWrapper.addEventListener("click", function() {
          if (!isSwiping) {
            window.location.href = REGISTER_URL;
          }
        });

        // 手機滑動切換
        carouselWrapper.addEventListener("touchstart", function(e) {
          if (e.touches.length === 1) {
            touchStartX = e.touches[0].clientX;
            isSwiping = false;
          }
        });

        carouselWrapper.addEventListener("touchmove", function(e) {
          if (!touchStartX) return;
          const dx = e.touches[0].clientX - touchStartX;
          if (Math.abs(dx) > 10) {
            isSwiping = true;
          }
        });

        carouselWrapper.addEventListener("touchend", function(e) {
          if (!touchStartX) return;
          const dx = e.changedTouches[0].clientX - touchStartX;
          if (isSwiping && Math.abs(dx) > 40) {
            if (dx < 0) nextSlide();
            else prevSlide();
          }
          touchStartX = null;
          restartAuto();
        });

        startAuto();
      }

      function updateCarousel() {
        const offset = -currentIndex * 100;
        inner.style.transform = "translateX(" + offset + "%)";
        const dots = dotsWrap.children;
        for (let i = 0; i < dots.length; i++) {
          dots[i].classList.toggle("active", i === currentIndex);
        }
      }

      function nextSlide() {
        if (banners.length <= 1) return;
        currentIndex = (currentIndex + 1) % banners.length;
        updateCarousel();
      }

      function prevSlide() {
        if (banners.length <= 1) return;
        currentIndex = (currentIndex - 1 + banners.length) % banners.length;
        updateCarousel();
      }

      function startAuto() {
        if (autoTimer) clearInterval(autoTimer);
        autoTimer = setInterval(nextSlide, 3000);
      }
      function restartAuto() {
        if (autoTimer) clearInterval(autoTimer);
        autoTimer = setInterval(nextSlide, 3000);
      }

      loadBanners();
    })();
  </script>
</body>
</html>
